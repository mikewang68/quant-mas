2025-08-20 20:16:47,713 - __main__ - INFO - Starting debug process for weekly selection
2025-08-20 20:16:47,713 - __main__ - INFO - === DEBUGGING STRATEGY PARAMETERS ===
2025-08-20 20:16:47,714 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Starting topology monitoring"}
2025-08-20 20:16:47,714 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "previousDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
2025-08-20 20:16:47,714 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "serverHost": "192.168.1.2", "serverPort": 27017, "message": "Starting server monitoring"}
2025-08-20 20:16:47,714 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection pool created", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,715 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}}
2025-08-20 20:16:47,715 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "remainingTimeMS": 29}
2025-08-20 20:16:47,715 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "driverConnectionId": 1, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
2025-08-20 20:16:47,716 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "driverConnectionId": 1, "serverConnectionId": 6544, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": false, "durationMS": 1.0011239937739447, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689566e93123d68cf8690e7b\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-08-20T12:15:38.691Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 6544, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-08-20 20:16:47,717 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection pool ready", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,717 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "previousDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "message": "Topology description changed"}
2025-08-20 20:16:47,717 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,717 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,717 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection created", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,717 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "driverConnectionId": 1, "serverConnectionId": 6544, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-08-20 20:16:47,721 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection ready", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0032622540020383894}
2025-08-20 20:16:47,721 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003911387997504789}
2025-08-20 20:16:47,721 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Command started", "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"1c4/OFdqQyil9P2Q+B/p9g==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 6545, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,722 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Command succeeded", "durationMS": 0.562, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 6545, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,722 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,722 - data.mongodb_manager - INFO - Successfully connected to MongoDB
2025-08-20 20:16:47,722 - __main__ - INFO - Connected to database
2025-08-20 20:16:47,722 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}}
2025-08-20 20:16:47,722 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,722 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,722 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.545799700077623e-05}
2025-08-20 20:16:47,722 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Command started", "command": "{\"find\": \"strategies\", \"projection\": {\"_id\": 1, \"name\": 1, \"type\": 1, \"description\": 1, \"parameters\": 1, \"program\": 1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"1c4/OFdqQyil9P2Q+B/p9g==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 6545, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,723 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Command succeeded", "durationMS": 1.23, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6a\"}, \"name\": \"\u4e09\u5747\u7ebf\u591a\u5934\u6392\u5217\u7b56\u7565\uff08\u57fa\u672c\u578b\uff09\", \"type\": \"technical\", \"description\": \"\u4f7f\u7528\u6590\u6ce2\u90a3\u5951\u6570\u5217\u8bbe\u7f6e3\u5747\u7ebf\uff0c\u5206\u522b\u662f5,13,34,\u5747\u7ebf\u591a\u5934\u6392\u5217\", \"parameters\": {\"ma_long\": \"34\", \"ma_mid\": \"13\", \"ma_short\": \"5\"}, \"program\": \"three_ma_bullish_arrangement_strategy.py\"}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6b\"}, \"name\": \"\u8d8b\u52bf\u8ddf\u8e2a\", \"type\": \"technical\", \"description\": \"test\"}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6c\"}, \"name\": \"\u673a\u5668\u5b66\u4e60\", \"type\": \"ml\", \"description\": \"test\"}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6d\"}, \"name\": \"\u6d4b\u8bd5\u7b56\u75651-RSI\", \"type\": \"rsi\", \"description\": \"\u6d4b\u8bd5RSI\u7b56\u7565\", \"parameters\": {\"rsi_period\": 14, \"rsi_min\": 30, \"rsi_max\": 70}}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6e\"}, \"name\": \"\u6d4b\u8bd5...", "commandName": "find", "databaseName": "stock", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 6545, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,724 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,724 - __main__ - INFO - Found 23 strategies in database
2025-08-20 20:16:47,724 - __main__ - INFO - Strategy name: 三均线多头排列策略（基本型）
2025-08-20 20:16:47,724 - __main__ - INFO - Strategy parameters: {'ma_long': '34', 'ma_mid': '13', 'ma_short': '5'}
2025-08-20 20:16:47,724 - __main__ - INFO - Strategy instantiated successfully with params: {'ma_long': '34', 'ma_mid': '13', 'ma_short': '5', 'short': 5, 'mid': 13, 'long': 34}
2025-08-20 20:16:47,724 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "PrimaryPreferred(tag_sets=None, max_staleness=-1, hedge=None)", "operation": "endSessions", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}}
2025-08-20 20:16:47,724 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "PrimaryPreferred(tag_sets=None, max_staleness=-1, hedge=None)", "operation": "endSessions", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,724 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,724 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.564100188668817e-05}
2025-08-20 20:16:47,724 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Command started", "command": "{\"endSessions\": [{\"id\": {\"$binary\": {\"base64\": \"1c4/OFdqQyil9P2Q+B/p9g==\", \"subType\": \"04\"}}}], \"$db\": \"admin\"}", "commandName": "endSessions", "databaseName": "admin", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 6545, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,724 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Command succeeded", "durationMS": 0.5199999999999999, "reply": "{\"ok\": 1.0}", "commandName": "endSessions", "databaseName": "admin", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 6545, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,725 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,725 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "serverHost": "192.168.1.2", "serverPort": 27017, "message": "Stopped server monitoring"}
2025-08-20 20:16:47,725 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection closed", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was closed", "error": "poolClosed"}
2025-08-20 20:16:47,725 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Connection pool closed", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,725 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "previousDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0010011239937739447>]>", "newDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f3, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
2025-08-20 20:16:47,725 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f3"}, "message": "Stopped topology monitoring"}
2025-08-20 20:16:47,725 - data.mongodb_manager - INFO - MongoDB connection closed
2025-08-20 20:16:47,725 - __main__ - INFO - === DEBUGGING DATA FLOW ===
2025-08-20 20:16:47,726 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Starting topology monitoring"}
2025-08-20 20:16:47,726 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "previousDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
2025-08-20 20:16:47,726 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017, "message": "Starting server monitoring"}
2025-08-20 20:16:47,726 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection pool created", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,726 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,726 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "remainingTimeMS": 29}
2025-08-20 20:16:47,726 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "driverConnectionId": 1, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": false, "message": "Server heartbeat started"}
2025-08-20 20:16:47,727 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "driverConnectionId": 1, "serverConnectionId": 6547, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": false, "durationMS": 0.7837800003471784, "reply": "{\"helloOk\": true, \"ismaster\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"689566e93123d68cf8690e7b\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"2025-08-20T12:15:38.702Z\"}, \"logicalSessionTimeoutMinutes\": 30, \"connectionId\": 6547, \"maxWireVersion\": 25, \"ok\": 1.0}", "message": "Server heartbeat succeeded"}
2025-08-20 20:16:47,727 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection pool ready", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,727 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "previousDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Unknown, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "message": "Topology description changed"}
2025-08-20 20:16:47,728 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "ping", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,728 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,728 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection created", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,728 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "driverConnectionId": 1, "serverConnectionId": 6547, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": true, "message": "Server heartbeat started"}
2025-08-20 20:16:47,730 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection ready", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002077386998280417}
2025-08-20 20:16:47,730 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00244438300433103}
2025-08-20 20:16:47,730 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"ping\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"admin\"}", "commandName": "ping", "databaseName": "admin", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,730 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.27599999999999997, "reply": "{\"ok\": 1.0}", "commandName": "ping", "databaseName": "admin", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,731 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,731 - data.mongodb_manager - INFO - Successfully connected to MongoDB
2025-08-20 20:16:47,731 - utils.akshare_client - INFO - AkshareClient initialized
2025-08-20 20:16:47,731 - __main__ - INFO - Initialized database manager and data fetcher
2025-08-20 20:16:47,731 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,731 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,731 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,731 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.3394004276487976e-05}
2025-08-20 20:16:47,731 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"strategies\", \"projection\": {\"_id\": 1, \"name\": 1, \"type\": 1, \"description\": 1, \"parameters\": 1, \"program\": 1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,731 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.51, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6a\"}, \"name\": \"\u4e09\u5747\u7ebf\u591a\u5934\u6392\u5217\u7b56\u7565\uff08\u57fa\u672c\u578b\uff09\", \"type\": \"technical\", \"description\": \"\u4f7f\u7528\u6590\u6ce2\u90a3\u5951\u6570\u5217\u8bbe\u7f6e3\u5747\u7ebf\uff0c\u5206\u522b\u662f5,13,34,\u5747\u7ebf\u591a\u5934\u6392\u5217\", \"parameters\": {\"ma_long\": \"34\", \"ma_mid\": \"13\", \"ma_short\": \"5\"}, \"program\": \"three_ma_bullish_arrangement_strategy.py\"}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6b\"}, \"name\": \"\u8d8b\u52bf\u8ddf\u8e2a\", \"type\": \"technical\", \"description\": \"test\"}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6c\"}, \"name\": \"\u673a\u5668\u5b66\u4e60\", \"type\": \"ml\", \"description\": \"test\"}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6d\"}, \"name\": \"\u6d4b\u8bd5\u7b56\u75651-RSI\", \"type\": \"rsi\", \"description\": \"\u6d4b\u8bd5RSI\u7b56\u7565\", \"parameters\": {\"rsi_period\": 14, \"rsi_min\": 30, \"rsi_max\": 70}}, {\"_id\": {\"$oid\": \"689e6bfdd227f4d150c07a6e\"}, \"name\": \"\u6d4b\u8bd5...", "commandName": "find", "databaseName": "stock", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,732 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,732 - __main__ - INFO - Loaded strategy: 三均线多头排列策略（基本型） with params: {'ma_long': '34', 'ma_mid': '13', 'ma_short': '5'}
2025-08-20 20:16:47,732 - __main__ - INFO - Strategy instantiated successfully
2025-08-20 20:16:47,732 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,732 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,732 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,732 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.409799683140591e-05}
2025-08-20 20:16:47,732 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"code\", \"projection\": {\"code\": 1}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,732 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.364, "reply": "{\"cursor\": {\"firstBatch\": [{\"code\": \"000001\"}, {\"code\": \"000002\"}, {\"code\": \"000004\"}, {\"code\": \"000006\"}, {\"code\": \"000007\"}, {\"code\": \"000008\"}, {\"code\": \"000009\"}, {\"code\": \"000010\"}, {\"code\": \"000011\"}, {\"code\": \"000012\"}, {\"code\": \"000014\"}, {\"code\": \"000016\"}, {\"code\": \"000017\"}, {\"code\": \"000019\"}, {\"code\": \"000020\"}, {\"code\": \"000021\"}, {\"code\": \"000025\"}, {\"code\": \"000026\"}, {\"code\": \"000027\"}, {\"code\": \"000028\"}, {\"code\": \"000029\"}, {\"code\": \"000030\"}, {\"code\": \"000031\"}, {\"code\": \"000032\"}, {\"code\": \"000034\"}, {\"code\": \"000035\"}, {\"code\": \"000036\"}, {\"code\": \"000037\"}, {\"code\": \"000039\"}, {\"code\": \"000042\"}, {\"code\": \"000045\"}, {\"code\": \"000048\"}, {\"code\": \"000049\"}, {\"code\": \"000050\"}, {\"code\": \"000055\"}, {\"code\": \"000056\"}, {\"code\": \"000058\"}, {\"code\": \"000059\"}, {\"code\": \"000060\"}, {\"code\": \"000061\"}, {\"code\": \"000062\"}, {\"code\": \"000063\"}, {\"code\": \"000065\"}, {\"code\": \"000066\"}, {\"code\": \"000068\"}, {\"code\": \"000069\"}, {\"code\": \"000070\"}, {\"code\": \"000078\"}, {\"code\": \"000...", "commandName": "find", "databaseName": "stock", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,732 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,732 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,733 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,733 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,733 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.24159991578199e-05}
2025-08-20 20:16:47,733 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"getMore\": 3787836850923075029, \"collection\": \"code\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "getMore", "databaseName": "stock", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,737 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 4.358, "reply": "{\"cursor\": {\"nextBatch\": [{\"code\": \"000518\"}, {\"code\": \"000519\"}, {\"code\": \"000520\"}, {\"code\": \"000521\"}, {\"code\": \"000523\"}, {\"code\": \"000524\"}, {\"code\": \"000525\"}, {\"code\": \"000526\"}, {\"code\": \"000528\"}, {\"code\": \"000529\"}, {\"code\": \"000530\"}, {\"code\": \"000531\"}, {\"code\": \"000532\"}, {\"code\": \"000533\"}, {\"code\": \"000534\"}, {\"code\": \"000536\"}, {\"code\": \"000537\"}, {\"code\": \"000538\"}, {\"code\": \"000539\"}, {\"code\": \"000541\"}, {\"code\": \"000543\"}, {\"code\": \"000544\"}, {\"code\": \"000545\"}, {\"code\": \"000546\"}, {\"code\": \"000547\"}, {\"code\": \"000548\"}, {\"code\": \"000550\"}, {\"code\": \"000551\"}, {\"code\": \"000552\"}, {\"code\": \"000553\"}, {\"code\": \"000554\"}, {\"code\": \"000555\"}, {\"code\": \"000557\"}, {\"code\": \"000558\"}, {\"code\": \"000559\"}, {\"code\": \"000560\"}, {\"code\": \"000561\"}, {\"code\": \"000563\"}, {\"code\": \"000564\"}, {\"code\": \"000565\"}, {\"code\": \"000566\"}, {\"code\": \"000567\"}, {\"code\": \"000568\"}, {\"code\": \"000570\"}, {\"code\": \"000571\"}, {\"code\": \"000572\"}, {\"code\": \"000573\"}, {\"code\": \"000576\"}, {\"code\": \"0005...", "commandName": "getMore", "databaseName": "stock", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,737 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,738 - __main__ - INFO - Total stock codes: 5424
2025-08-20 20:16:47,738 - __main__ - INFO - Testing with sample codes: ['000001', '000002', '000004', '000006', '000007']
2025-08-20 20:16:47,738 - __main__ - INFO - Date range: 2024-08-20 to 2025-08-20
2025-08-20 20:16:47,738 - __main__ - INFO - Processing stock: 000001
2025-08-20 20:16:47,738 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,738 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,738 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,738 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.527000080794096e-05}
2025-08-20 20:16:47,738 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"config\", \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,739 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.299, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689735b83123d68cf8690e7f\"}, \"commission\": 0.001, \"data_adjustment\": \"qfq\", \"max_position\": 0.1, \"stop_loss\": 0.05, \"take_profit\": 0.1}], \"ns\": \"stock.config\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "stock", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,739 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,739 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,739 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,739 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,739 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.362099960213527e-05}
2025-08-20 20:16:47,739 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"k_data\", \"filter\": {\"\\u4ee3\\u7801\": \"000001\", \"\\u65e5\\u671f\": {\"$gte\": \"2024-08-20\", \"$lte\": \"2025-08-20\"}}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,740 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.218, "reply": "{\"cursor\": {\"firstBatch\": [{\"\u4ee3\u7801\": \"000001\", \"\u5f00\u76d8\": 10.32, \"\u5f00\u76d8h\": 1574.2, \"\u5f00\u76d8q\": 9.71, \"\u6210\u4ea4\u91cf\": 1569187, \"\u6210\u4ea4\u91cfh\": 1569187, \"\u6210\u4ea4\u91cfq\": 1569187, \"\u6210\u4ea4\u989d\": 1623147686.36, \"\u6210\u4ea4\u989dh\": 1623147686.36, \"\u6210\u4ea4\u989dq\": 1623147686.36, \"\u632f\u5e45\": 1.46, \"\u632f\u5e45h\": 1.19, \"\u632f\u5e45q\": 1.55, \"\u6362\u624b\u7387\": 0.81, \"\u6362\u624b\u7387h\": 0.81, \"\u6362\u624b\u7387q\": 0.81, \"\u6536\u76d8\": 10.34, \"\u6536\u76d8h\": 1576.7, \"\u6536\u76d8q\": 9.73, \"\u65e5\u671f\": \"2024-08-20\", \"\u6700\u4f4e\": 10.28, \"\u6700\u4f4eh\": 1569.2, \"\u6700\u4f4eq\": 9.67, \"\u6700\u9ad8\": 10.43, \"\u6700\u9ad8h\": 1587.95, \"\u6700\u9ad8q\": 9.82, \"\u6da8\u8dcc\u5e45\": 0.49, \"\u6da8\u8dcc\u5e45h\": 0.4, \"\u6da8\u8dcc\u5e45q\": 0.52, \"\u6da8\u8dcc\u989d\": 0.05, \"\u6da8\u8dcc\u989dh\": 6.25, \"\u6da8\u8dcc\u989dq\": 0.05, \"\u80a1\u7968\u4ee3\u7801\": \"000001\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000001\", \"\u80a1\u7968\u4ee3...", "commandName": "find", "databaseName": "stock", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,741 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,741 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,741 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,741 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,741 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.257500065956265e-05}
2025-08-20 20:16:47,741 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"getMore\": 505803646300908065, \"collection\": \"k_data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "getMore", "databaseName": "stock", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,742 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.209, "reply": "{\"cursor\": {\"nextBatch\": [{\"\u4ee3\u7801\": \"000001\", \"\u5f00\u76d8\": 11.5, \"\u5f00\u76d8h\": 1752.48, \"\u5f00\u76d8q\": 11.14, \"\u6210\u4ea4\u91cf\": 832029, \"\u6210\u4ea4\u91cfh\": 832029, \"\u6210\u4ea4\u91cfq\": 832029, \"\u6210\u4ea4\u989d\": 953092179.17, \"\u6210\u4ea4\u989dh\": 953092179.17, \"\u6210\u4ea4\u989dq\": 953092179.17, \"\u632f\u5e45\": 1.05, \"\u632f\u5e45h\": 0.86, \"\u632f\u5e45q\": 1.08, \"\u6362\u624b\u7387\": 0.43, \"\u6362\u624b\u7387h\": 0.43, \"\u6362\u624b\u7387q\": 0.43, \"\u6536\u76d8\": 11.42, \"\u6536\u76d8h\": 1742.48, \"\u6536\u76d8q\": 11.06, \"\u65e5\u671f\": \"2025-01-20\", \"\u6700\u4f4e\": 11.4, \"\u6700\u4f4eh\": 1739.97, \"\u6700\u4f4eq\": 11.04, \"\u6700\u9ad8\": 11.52, \"\u6700\u9ad8h\": 1754.98, \"\u6700\u9ad8q\": 11.16, \"\u6da8\u8dcc\u5e45\": -0.26, \"\u6da8\u8dcc\u5e45h\": -0.21, \"\u6da8\u8dcc\u5e45q\": -0.27, \"\u6da8\u8dcc\u989d\": -0.03, \"\u6da8\u8dcc\u989dh\": -3.75, \"\u6da8\u8dcc\u989dq\": -0.03, \"\u80a1\u7968\u4ee3\u7801\": \"000001\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000001\", \"\u80a1\u7968...", "commandName": "getMore", "databaseName": "stock", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,743 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,745 - data.mongodb_manager - INFO - Retrieved adjusted K-data for 000001 with qfq adjustment
2025-08-20 20:16:47,745 - __main__ - INFO - Daily data shape for 000001: (240, 7)
2025-08-20 20:16:47,748 - __main__ - INFO - Weekly data shape for 000001: (52, 7)
2025-08-20 20:16:47,748 - __main__ - INFO - Strategy result for 000001: meets_criteria=False, reason=不满足条件: 价格未形成多头排列(收盘价=12.08, MA5=12.36, MA13=12.04, MA34=11.42), score=None
2025-08-20 20:16:47,748 - __main__ - INFO - Stock 000001 NOT selected: 不满足条件: 价格未形成多头排列(收盘价=12.08, MA5=12.36, MA13=12.04, MA34=11.42)
2025-08-20 20:16:47,748 - __main__ - INFO - Processing stock: 000002
2025-08-20 20:16:47,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,748 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,748 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,748 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.811399801634252e-05}
2025-08-20 20:16:47,748 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"config\", \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,749 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.309, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689735b83123d68cf8690e7f\"}, \"commission\": 0.001, \"data_adjustment\": \"qfq\", \"max_position\": 0.1, \"stop_loss\": 0.05, \"take_profit\": 0.1}], \"ns\": \"stock.config\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "stock", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,749 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,749 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,749 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,749 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,749 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.272300091339275e-05}
2025-08-20 20:16:47,749 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"k_data\", \"filter\": {\"\\u4ee3\\u7801\": \"000002\", \"\\u65e5\\u671f\": {\"$gte\": \"2024-08-20\", \"$lte\": \"2025-08-20\"}}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,750 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.073, "reply": "{\"cursor\": {\"firstBatch\": [{\"\u4ee3\u7801\": \"000002\", \"\u5f00\u76d8\": 6.79, \"\u5f00\u76d8h\": 2059.39, \"\u5f00\u76d8q\": 6.79, \"\u6210\u4ea4\u91cf\": 861589, \"\u6210\u4ea4\u91cfh\": 861589, \"\u6210\u4ea4\u91cfq\": 861589, \"\u6210\u4ea4\u989d\": 578194586.24, \"\u6210\u4ea4\u989dh\": 578194586.24, \"\u6210\u4ea4\u989dq\": 578194586.24, \"\u632f\u5e45\": 2.21, \"\u632f\u5e45h\": 0.95, \"\u632f\u5e45q\": 2.21, \"\u6362\u624b\u7387\": 0.89, \"\u6362\u624b\u7387h\": 0.89, \"\u6362\u624b\u7387q\": 0.89, \"\u6536\u76d8\": 6.67, \"\u6536\u76d8h\": 2043.68, \"\u6536\u76d8q\": 6.67, \"\u65e5\u671f\": \"2024-08-20\", \"\u6700\u4f4e\": 6.66, \"\u6700\u4f4eh\": 2042.37, \"\u6700\u4f4eq\": 6.66, \"\u6700\u9ad8\": 6.81, \"\u6700\u9ad8h\": 2062.01, \"\u6700\u9ad8q\": 6.81, \"\u6da8\u8dcc\u5e45\": -1.91, \"\u6da8\u8dcc\u5e45h\": -0.83, \"\u6da8\u8dcc\u5e45q\": -1.91, \"\u6da8\u8dcc\u989d\": -0.13, \"\u6da8\u8dcc\u989dh\": -17.02, \"\u6da8\u8dcc\u989dq\": -0.13, \"\u80a1\u7968\u4ee3\u7801\": \"000002\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000002\", \"\u80a1\u7968\u4ee3...", "commandName": "find", "databaseName": "stock", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,750 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,750 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,751 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,751 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,751 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.3863994758576155e-05}
2025-08-20 20:16:47,751 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"getMore\": 4304809924615069010, \"collection\": \"k_data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "getMore", "databaseName": "stock", "requestId": 2145174067, "operationId": 2145174067, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,752 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.1900000000000002, "reply": "{\"cursor\": {\"nextBatch\": [{\"\u4ee3\u7801\": \"000002\", \"\u5f00\u76d8\": 6.6, \"\u5f00\u76d8h\": 2034.52, \"\u5f00\u76d8q\": 6.6, \"\u6210\u4ea4\u91cf\": 2988167, \"\u6210\u4ea4\u91cfh\": 2988167, \"\u6210\u4ea4\u91cfq\": 2988167, \"\u6210\u4ea4\u989d\": 2009728943.98, \"\u6210\u4ea4\u989dh\": 2009728943.98, \"\u6210\u4ea4\u989dq\": 2009728943.98, \"\u632f\u5e45\": 6.94, \"\u632f\u5e45h\": 2.95, \"\u632f\u5e45q\": 6.94, \"\u6362\u624b\u7387\": 3.08, \"\u6362\u624b\u7387h\": 3.08, \"\u6362\u624b\u7387q\": 3.08, \"\u6536\u76d8\": 6.85, \"\u6536\u76d8h\": 2067.24, \"\u6536\u76d8q\": 6.85, \"\u65e5\u671f\": \"2025-01-20\", \"\u6700\u4f4e\": 6.48, \"\u6700\u4f4eh\": 2018.81, \"\u6700\u4f4eq\": 6.48, \"\u6700\u9ad8\": 6.94, \"\u6700\u9ad8h\": 2079.03, \"\u6700\u9ad8q\": 6.94, \"\u6da8\u8dcc\u5e45\": 3.32, \"\u6da8\u8dcc\u5e45h\": 1.41, \"\u6da8\u8dcc\u5e45q\": 3.32, \"\u6da8\u8dcc\u989d\": 0.22, \"\u6da8\u8dcc\u989dh\": 28.8, \"\u6da8\u8dcc\u989dq\": 0.22, \"\u80a1\u7968\u4ee3\u7801\": \"000002\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000002\", \"\u80a1\u7968\u4ee3...", "commandName": "getMore", "databaseName": "stock", "requestId": 2145174067, "operationId": 2145174067, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,752 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,754 - data.mongodb_manager - INFO - Retrieved adjusted K-data for 000002 with qfq adjustment
2025-08-20 20:16:47,754 - __main__ - INFO - Daily data shape for 000002: (240, 7)
2025-08-20 20:16:47,756 - __main__ - INFO - Weekly data shape for 000002: (52, 7)
2025-08-20 20:16:47,756 - __main__ - INFO - Strategy result for 000002: meets_criteria=False, reason=不满足条件: 价格未形成多头排列(收盘价=6.53, MA5=6.54, MA13=6.53, MA34=6.96); 均线趋势不符合: 0/3个趋势为正 (MA5未上升, MA13未上升, MA34未上升), score=None
2025-08-20 20:16:47,756 - __main__ - INFO - Stock 000002 NOT selected: 不满足条件: 价格未形成多头排列(收盘价=6.53, MA5=6.54, MA13=6.53, MA34=6.96); 均线趋势不符合: 0/3个趋势为正 (MA5未上升, MA13未上升, MA34未上升)
2025-08-20 20:16:47,756 - __main__ - INFO - Processing stock: 000004
2025-08-20 20:16:47,756 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,756 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,756 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,756 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.812100476352498e-05}
2025-08-20 20:16:47,756 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"config\", \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 468703135, "operationId": 468703135, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,757 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.301, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689735b83123d68cf8690e7f\"}, \"commission\": 0.001, \"data_adjustment\": \"qfq\", \"max_position\": 0.1, \"stop_loss\": 0.05, \"take_profit\": 0.1}], \"ns\": \"stock.config\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "stock", "requestId": 468703135, "operationId": 468703135, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,757 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,757 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,757 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,757 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,757 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.405600000405684e-05}
2025-08-20 20:16:47,757 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"k_data\", \"filter\": {\"\\u4ee3\\u7801\": \"000004\", \"\\u65e5\\u671f\": {\"$gte\": \"2024-08-20\", \"$lte\": \"2025-08-20\"}}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,758 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.026, "reply": "{\"cursor\": {\"firstBatch\": [{\"\u4ee3\u7801\": \"000004\", \"\u5f00\u76d8\": 10.8, \"\u5f00\u76d8h\": 38.77, \"\u5f00\u76d8q\": 10.8, \"\u6210\u4ea4\u91cf\": 51784, \"\u6210\u4ea4\u91cfh\": 51784, \"\u6210\u4ea4\u91cfq\": 51784, \"\u6210\u4ea4\u989d\": 54375297.0, \"\u6210\u4ea4\u989dh\": 54375297.0, \"\u6210\u4ea4\u989dq\": 54375297.0, \"\u632f\u5e45\": 3.96, \"\u632f\u5e45h\": 4.46, \"\u632f\u5e45q\": 3.96, \"\u6362\u624b\u7387\": 4.1, \"\u6362\u624b\u7387h\": 4.1, \"\u6362\u624b\u7387q\": 4.1, \"\u6536\u76d8\": 10.41, \"\u6536\u76d8h\": 37.19, \"\u6536\u76d8q\": 10.41, \"\u65e5\u671f\": \"2024-08-20\", \"\u6700\u4f4e\": 10.37, \"\u6700\u4f4eh\": 37.03, \"\u6700\u4f4eq\": 10.37, \"\u6700\u9ad8\": 10.8, \"\u6700\u9ad8h\": 38.77, \"\u6700\u9ad8q\": 10.8, \"\u6da8\u8dcc\u5e45\": -4.23, \"\u6da8\u8dcc\u5e45h\": -4.76, \"\u6da8\u8dcc\u5e45q\": -4.23, \"\u6da8\u8dcc\u989d\": -0.46, \"\u6da8\u8dcc\u989dh\": -1.86, \"\u6da8\u8dcc\u989dq\": -0.46, \"\u80a1\u7968\u4ee3\u7801\": \"000004\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000004\", \"\u80a1\u7968\u4ee3\u7801_y\": \"00000...", "commandName": "find", "databaseName": "stock", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,759 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,759 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,759 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,759 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,759 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.355099761392921e-05}
2025-08-20 20:16:47,759 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"getMore\": 5897459059270517196, \"collection\": \"k_data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "getMore", "databaseName": "stock", "requestId": 1801979802, "operationId": 1801979802, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,760 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.23, "reply": "{\"cursor\": {\"nextBatch\": [{\"\u4ee3\u7801\": \"000004\", \"\u5f00\u76d8\": 11.97, \"\u5f00\u76d8h\": 43.49, \"\u5f00\u76d8q\": 11.97, \"\u6210\u4ea4\u91cf\": 44590, \"\u6210\u4ea4\u91cfh\": 44590, \"\u6210\u4ea4\u91cfq\": 44590, \"\u6210\u4ea4\u989d\": 53374230.0, \"\u6210\u4ea4\u989dh\": 53374230.0, \"\u6210\u4ea4\u989dq\": 53374230.0, \"\u6362\u624b\u7387\": 3.53, \"\u6362\u624b\u7387h\": 3.53, \"\u6362\u624b\u7387q\": 3.53, \"\u6536\u76d8\": 11.97, \"\u6536\u76d8h\": 43.49, \"\u6536\u76d8q\": 11.97, \"\u65e5\u671f\": \"2025-01-20\", \"\u6700\u4f4e\": 11.97, \"\u6700\u4f4eh\": 43.49, \"\u6700\u4f4eq\": 11.97, \"\u6700\u9ad8\": 11.97, \"\u6700\u9ad8h\": 43.49, \"\u6700\u9ad8q\": 11.97, \"\u6da8\u8dcc\u5e45\": -10.0, \"\u6da8\u8dcc\u5e45h\": -10.99, \"\u6da8\u8dcc\u5e45q\": -10.0, \"\u6da8\u8dcc\u989d\": -1.33, \"\u6da8\u8dcc\u989dh\": -5.37, \"\u6da8\u8dcc\u989dq\": -1.33, \"\u80a1\u7968\u4ee3\u7801\": \"000004\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000004\", \"\u80a1\u7968\u4ee3\u7801_y\": \"000004\"}, {\"\u4ee3\u7801\": \"000004\", \"\u5f00\u76d8\": 11.25, \"...", "commandName": "getMore", "databaseName": "stock", "requestId": 1801979802, "operationId": 1801979802, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,761 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,762 - data.mongodb_manager - INFO - Retrieved adjusted K-data for 000004 with qfq adjustment
2025-08-20 20:16:47,762 - __main__ - INFO - Daily data shape for 000004: (239, 7)
2025-08-20 20:16:47,764 - __main__ - INFO - Weekly data shape for 000004: (52, 7)
2025-08-20 20:16:47,764 - __main__ - INFO - Strategy result for 000004: meets_criteria=False, reason=不满足条件: 价格未形成多头排列(收盘价=9.22, MA5=8.92, MA13=9.11, MA34=10.35), score=None
2025-08-20 20:16:47,764 - __main__ - INFO - Stock 000004 NOT selected: 不满足条件: 价格未形成多头排列(收盘价=9.22, MA5=8.92, MA13=9.11, MA34=10.35)
2025-08-20 20:16:47,764 - __main__ - INFO - Processing stock: 000006
2025-08-20 20:16:47,764 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,764 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,764 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,764 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 4.1481005609966815e-05}
2025-08-20 20:16:47,764 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"config\", \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 1315634022, "operationId": 1315634022, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,765 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.301, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689735b83123d68cf8690e7f\"}, \"commission\": 0.001, \"data_adjustment\": \"qfq\", \"max_position\": 0.1, \"stop_loss\": 0.05, \"take_profit\": 0.1}], \"ns\": \"stock.config\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "stock", "requestId": 1315634022, "operationId": 1315634022, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,765 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,765 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,765 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,765 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,765 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.207499685231596e-05}
2025-08-20 20:16:47,765 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"k_data\", \"filter\": {\"\\u4ee3\\u7801\": \"000006\", \"\\u65e5\\u671f\": {\"$gte\": \"2024-08-20\", \"$lte\": \"2025-08-20\"}}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 635723058, "operationId": 635723058, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,766 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.017, "reply": "{\"cursor\": {\"firstBatch\": [{\"\u4ee3\u7801\": \"000006\", \"\u5f00\u76d8\": 3.76, \"\u5f00\u76d8h\": 204.08, \"\u5f00\u76d8q\": 3.76, \"\u6210\u4ea4\u91cf\": 116232, \"\u6210\u4ea4\u91cfh\": 116232, \"\u6210\u4ea4\u91cfq\": 116232, \"\u6210\u4ea4\u989d\": 43313087.0, \"\u6210\u4ea4\u989dh\": 43313087.0, \"\u6210\u4ea4\u989dq\": 43313087.0, \"\u632f\u5e45\": 2.65, \"\u632f\u5e45h\": 1.86, \"\u632f\u5e45q\": 2.65, \"\u6362\u624b\u7387\": 0.86, \"\u6362\u624b\u7387h\": 0.86, \"\u6362\u624b\u7387q\": 0.86, \"\u6536\u76d8\": 3.7, \"\u6536\u76d8h\": 201.79, \"\u6536\u76d8q\": 3.7, \"\u65e5\u671f\": \"2024-08-20\", \"\u6700\u4f4e\": 3.69, \"\u6700\u4f4eh\": 201.41, \"\u6700\u4f4eq\": 3.69, \"\u6700\u9ad8\": 3.79, \"\u6700\u9ad8h\": 205.22, \"\u6700\u9ad8q\": 3.79, \"\u6da8\u8dcc\u5e45\": -1.86, \"\u6da8\u8dcc\u5e45h\": -1.31, \"\u6da8\u8dcc\u5e45q\": -1.86, \"\u6da8\u8dcc\u989d\": -0.07, \"\u6da8\u8dcc\u989dh\": -2.67, \"\u6da8\u8dcc\u989dq\": -0.07, \"\u80a1\u7968\u4ee3\u7801\": \"000006\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000006\", \"\u80a1\u7968\u4ee3\u7801_y\": \"0...", "commandName": "find", "databaseName": "stock", "requestId": 635723058, "operationId": 635723058, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,767 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,767 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,767 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,767 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,767 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.282100078649819e-05}
2025-08-20 20:16:47,767 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"getMore\": 7267801045596082156, \"collection\": \"k_data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "getMore", "databaseName": "stock", "requestId": 1369133069, "operationId": 1369133069, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,768 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.2, "reply": "{\"cursor\": {\"nextBatch\": [{\"\u4ee3\u7801\": \"000006\", \"\u5f00\u76d8\": 6.9, \"\u5f00\u76d8h\": 323.7, \"\u5f00\u76d8q\": 6.9, \"\u6210\u4ea4\u91cf\": 400798, \"\u6210\u4ea4\u91cfh\": 400798, \"\u6210\u4ea4\u91cfq\": 400798, \"\u6210\u4ea4\u989d\": 291054654.49, \"\u6210\u4ea4\u989dh\": 291054654.49, \"\u6210\u4ea4\u989dq\": 291054654.49, \"\u632f\u5e45\": 11.47, \"\u632f\u5e45h\": 9.29, \"\u632f\u5e45q\": 11.47, \"\u6362\u624b\u7387\": 2.97, \"\u6362\u624b\u7387h\": 2.97, \"\u6362\u624b\u7387q\": 2.97, \"\u6536\u76d8\": 7.48, \"\u6536\u76d8h\": 345.8, \"\u6536\u76d8q\": 7.48, \"\u65e5\u671f\": \"2025-01-20\", \"\u6700\u4f4e\": 6.7, \"\u6700\u4f4eh\": 316.08, \"\u6700\u4f4eq\": 6.7, \"\u6700\u9ad8\": 7.48, \"\u6700\u9ad8h\": 345.8, \"\u6700\u9ad8q\": 7.48, \"\u6da8\u8dcc\u5e45\": 10.0, \"\u6da8\u8dcc\u5e45h\": 8.1, \"\u6da8\u8dcc\u5e45q\": 10.0, \"\u6da8\u8dcc\u989d\": 0.68, \"\u6da8\u8dcc\u989dh\": 25.91, \"\u6da8\u8dcc\u989dq\": 0.68, \"\u80a1\u7968\u4ee3\u7801\": \"000006\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000006\", \"\u80a1\u7968\u4ee3\u7801_y\": \"00000...", "commandName": "getMore", "databaseName": "stock", "requestId": 1369133069, "operationId": 1369133069, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,768 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,770 - data.mongodb_manager - INFO - Retrieved adjusted K-data for 000006 with qfq adjustment
2025-08-20 20:16:47,770 - __main__ - INFO - Daily data shape for 000006: (240, 7)
2025-08-20 20:16:47,772 - __main__ - INFO - Weekly data shape for 000006: (52, 7)
2025-08-20 20:16:47,772 - __main__ - INFO - Strategy result for 000006: meets_criteria=False, reason=不满足条件: 价格未形成多头排列(收盘价=7.33, MA5=6.50, MA13=6.62, MA34=6.71), score=None
2025-08-20 20:16:47,772 - __main__ - INFO - Stock 000006 NOT selected: 不满足条件: 价格未形成多头排列(收盘价=7.33, MA5=6.50, MA13=6.62, MA34=6.71)
2025-08-20 20:16:47,772 - __main__ - INFO - Processing stock: 000007
2025-08-20 20:16:47,772 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,772 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,772 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,772 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.727600415004417e-05}
2025-08-20 20:16:47,772 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"config\", \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 1125898167, "operationId": 1125898167, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,773 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.29, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"689735b83123d68cf8690e7f\"}, \"commission\": 0.001, \"data_adjustment\": \"qfq\", \"max_position\": 0.1, \"stop_loss\": 0.05, \"take_profit\": 0.1}], \"ns\": \"stock.config\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "stock", "requestId": 1125898167, "operationId": 1125898167, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,773 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,773 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,773 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,773 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,773 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.2948999432846904e-05}
2025-08-20 20:16:47,773 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"find\": \"k_data\", \"filter\": {\"\\u4ee3\\u7801\": \"000007\", \"\\u65e5\\u671f\": {\"$gte\": \"2024-08-20\", \"$lte\": \"2025-08-20\"}}, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "find", "databaseName": "stock", "requestId": 1059961393, "operationId": 1059961393, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,774 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.0839999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"\u4ee3\u7801\": \"000007\", \"\u5f00\u76d8\": 4.41, \"\u5f00\u76d8h\": 61.2, \"\u5f00\u76d8q\": 4.41, \"\u6210\u4ea4\u91cf\": 20444, \"\u6210\u4ea4\u91cfh\": 20444, \"\u6210\u4ea4\u91cfq\": 20444, \"\u6210\u4ea4\u989d\": 8867984.0, \"\u6210\u4ea4\u989dh\": 8867984.0, \"\u6210\u4ea4\u989dq\": 8867984.0, \"\u632f\u5e45\": 2.74, \"\u632f\u5e45h\": 3.05, \"\u632f\u5e45q\": 2.74, \"\u6362\u624b\u7387\": 0.66, \"\u6362\u624b\u7387h\": 0.66, \"\u6362\u624b\u7387q\": 0.66, \"\u6536\u76d8\": 4.32, \"\u6536\u76d8h\": 59.81, \"\u6536\u76d8q\": 4.32, \"\u65e5\u671f\": \"2024-08-20\", \"\u6700\u4f4e\": 4.29, \"\u6700\u4f4eh\": 59.35, \"\u6700\u4f4eq\": 4.29, \"\u6700\u9ad8\": 4.41, \"\u6700\u9ad8h\": 61.2, \"\u6700\u9ad8q\": 4.41, \"\u6da8\u8dcc\u5e45\": -1.37, \"\u6da8\u8dcc\u5e45h\": -1.53, \"\u6da8\u8dcc\u5e45q\": -1.37, \"\u6da8\u8dcc\u989d\": -0.06, \"\u6da8\u8dcc\u989dh\": -0.93, \"\u6da8\u8dcc\u989dq\": -0.06, \"\u80a1\u7968\u4ee3\u7801\": \"000007\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000007\", \"\u80a1\u7968\u4ee3\u7801_y\": \"000007\"}, {...", "commandName": "find", "databaseName": "stock", "requestId": 1059961393, "operationId": 1059961393, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,775 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,775 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,775 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "<function any_server_selector at 0x7f08eba549a0>", "operation": "getMore", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,775 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,775 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.399499837541953e-05}
2025-08-20 20:16:47,775 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"getMore\": 8462174169360923374, \"collection\": \"k_data\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}, \"$db\": \"stock\"}", "commandName": "getMore", "databaseName": "stock", "requestId": 2089018456, "operationId": 2089018456, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,776 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 1.2489999999999999, "reply": "{\"cursor\": {\"nextBatch\": [{\"\u4ee3\u7801\": \"000007\", \"\u5f00\u76d8\": 7.12, \"\u5f00\u76d8h\": 102.98, \"\u5f00\u76d8q\": 7.12, \"\u6210\u4ea4\u91cf\": 65184, \"\u6210\u4ea4\u91cfh\": 65184, \"\u6210\u4ea4\u91cfq\": 65184, \"\u6210\u4ea4\u989d\": 47183570.13, \"\u6210\u4ea4\u989dh\": 47183570.13, \"\u6210\u4ea4\u989dq\": 47183570.13, \"\u632f\u5e45\": 4.23, \"\u632f\u5e45h\": 4.5, \"\u632f\u5e45q\": 4.23, \"\u6362\u624b\u7387\": 1.88, \"\u6362\u624b\u7387h\": 1.88, \"\u6362\u624b\u7387q\": 1.88, \"\u6536\u76d8\": 7.19, \"\u6536\u76d8h\": 104.06, \"\u6536\u76d8q\": 7.19, \"\u65e5\u671f\": \"2025-01-20\", \"\u6700\u4f4e\": 7.03, \"\u6700\u4f4eh\": 101.6, \"\u6700\u4f4eq\": 7.03, \"\u6700\u9ad8\": 7.33, \"\u6700\u9ad8h\": 106.22, \"\u6700\u9ad8q\": 7.33, \"\u6da8\u8dcc\u5e45\": 1.27, \"\u6da8\u8dcc\u5e45h\": 1.34, \"\u6da8\u8dcc\u5e45q\": 1.27, \"\u6da8\u8dcc\u989d\": 0.09, \"\u6da8\u8dcc\u989dh\": 1.38, \"\u6da8\u8dcc\u989dq\": 0.09, \"\u80a1\u7968\u4ee3\u7801\": \"000007\", \"\u80a1\u7968\u4ee3\u7801_x\": \"000007\", \"\u80a1\u7968\u4ee3\u7801_y\": \"000007\"}...", "commandName": "getMore", "databaseName": "stock", "requestId": 2089018456, "operationId": 2089018456, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,777 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,778 - data.mongodb_manager - INFO - Retrieved adjusted K-data for 000007 with qfq adjustment
2025-08-20 20:16:47,778 - __main__ - INFO - Daily data shape for 000007: (240, 7)
2025-08-20 20:16:47,780 - __main__ - INFO - Weekly data shape for 000007: (52, 7)
2025-08-20 20:16:47,780 - __main__ - INFO - Strategy result for 000007: meets_criteria=False, reason=不满足条件: 价格未形成多头排列(收盘价=7.33, MA5=7.27, MA13=7.54, MA34=6.99), score=None
2025-08-20 20:16:47,780 - __main__ - INFO - Stock 000007 NOT selected: 不满足条件: 价格未形成多头排列(收盘价=7.33, MA5=7.27, MA13=7.54, MA34=6.99)
2025-08-20 20:16:47,780 - __main__ - INFO - Selected stocks: []
2025-08-20 20:16:47,780 - __main__ - INFO - Total selected: 0
2025-08-20 20:16:47,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "PrimaryPreferred(tag_sets=None, max_staleness=-1, hedge=None)", "operation": "endSessions", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}}
2025-08-20 20:16:47,780 - pymongo.serverSelection - DEBUG - {"message": "Server selection succeeded", "selector": "PrimaryPreferred(tag_sets=None, max_staleness=-1, hedge=None)", "operation": "endSessions", "topologyDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,780 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checkout started", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,780 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked out", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 3.743900015251711e-05}
2025-08-20 20:16:47,780 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command started", "command": "{\"endSessions\": [{\"id\": {\"$binary\": {\"base64\": \"xA1/Z/9FTMafRWp4NIVN5w==\", \"subType\": \"04\"}}}], \"$db\": \"admin\"}", "commandName": "endSessions", "databaseName": "admin", "requestId": 628175011, "operationId": 628175011, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,781 - pymongo.command - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Command succeeded", "durationMS": 0.254, "reply": "{\"ok\": 1.0}", "commandName": "endSessions", "databaseName": "admin", "requestId": 628175011, "operationId": 628175011, "driverConnectionId": 1, "serverConnectionId": 6548, "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,781 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection checked in", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1}
2025-08-20 20:16:47,781 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "serverHost": "192.168.1.2", "serverPort": 27017, "message": "Stopped server monitoring"}
2025-08-20 20:16:47,781 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection closed", "serverHost": "192.168.1.2", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was closed", "error": "poolClosed"}
2025-08-20 20:16:47,781 - pymongo.connection - DEBUG - {"clientId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Connection pool closed", "serverHost": "192.168.1.2", "serverPort": 27017}
2025-08-20 20:16:47,781 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "previousDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Standalone, rtt: 0.0007837800003471784>]>", "newDescription": "<TopologyDescription id: 68a5bcaff3b5de8b9bfce7f4, topology_type: Single, servers: [<ServerDescription ('192.168.1.2', 27017) server_type: Unknown, rtt: None>]>", "message": "Topology description changed"}
2025-08-20 20:16:47,781 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f4"}, "message": "Stopped topology monitoring"}
2025-08-20 20:16:47,781 - data.mongodb_manager - INFO - MongoDB connection closed
2025-08-20 20:16:47,781 - __main__ - INFO - === DEBUGGING STRATEGY LOGIC ===
2025-08-20 20:16:47,782 - __main__ - INFO - Sample data shape: (50, 7)
2025-08-20 20:16:47,784 - __main__ - INFO - Sample data head:
        date       open       high        low      close   volume        amount
0 2023-01-06  10.043390  10.453324   9.735939  10.248357  2285160  2.261724e+07
1 2023-01-13   9.932250  10.337648   9.628202  10.134949  2610908  1.200043e+07
2 2023-01-20  10.517367  10.946648  10.195407  10.732008  2886222  1.302887e+07
3 2023-01-27  11.146285  11.601235  10.805072  11.373760  1978732  4.705016e+07
4 2023-02-03  10.485265  10.913235  10.164287  10.699250  2425472  3.980384e+07
2025-08-20 20:16:47,784 - __main__ - INFO - Ideal data test - meets_criteria: False, reason: 不满足条件: 价格未形成多头排列(收盘价=19.12, MA5=19.44, MA13=18.56, MA34=16.47), score: None
2025-08-20 20:16:47,784 - __main__ - INFO - Strategy with DB params instantiated, params: {'ma_short': 5, 'ma_mid': 13, 'ma_long': 34, 'short': 5, 'mid': 13, 'long': 34}
2025-08-20 20:16:47,785 - __main__ - INFO - DB params test - meets_criteria: False, reason: 不满足条件: 价格未形成多头排列(收盘价=19.12, MA5=19.44, MA13=18.56, MA34=16.47), score: None
2025-08-20 20:16:47,785 - __main__ - INFO - Debug process completed
2025-08-20 20:16:48,054 - pymongo.topology - DEBUG - {"topologyId": {"$oid": "68a5bcaff3b5de8b9bfce7f2"}, "serverHost": "192.168.1.2", "serverPort": 27017, "awaited": true, "durationMS": 500.77138399501564, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1, "message": "Server heartbeat failed"}
